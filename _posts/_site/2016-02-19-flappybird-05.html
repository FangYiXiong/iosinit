<p>原文地址：<a href="http://iOSinit.com/flappybird-05">第5节：碰撞体积</a></p>

<p>相关视频地址：<a href="http://study.163.com/course/introduction/1685005.htm">网易云课堂</a></p>

<p>嗨，大家好，我是方一雄。欢迎大家继续收看<a href="http://study.163.com/course/introduction/1685005.htm">「从零开始」做一个 FlappyBird 那样的游戏</a> 这一系列教学视频。</p>

<p>在本节的视频中，你将会学习添加物品的碰撞体积。</p>

<p>刚刚这个视频展示的是让我们完成本节之后的效果。看的事情请注意游戏中主角，障碍物和地面周围的蓝色的线条，这些就是我们在本节课上要定义的物体的碰撞体积。</p>

<h2 id="section">理论讲解</h2>

<h3 id="section-1">总的目标</h3>

<ol>
  <li>
    <p>使用苹果的游戏框架 Sprite Kit 来处理碰撞检测</p>

    <p>我们使用 Sprite Kit 的一个很大的优点就是它拥有内置的物理引擎来处理类似碰撞检测这种问题。使用它的方法就是我们要给游戏中的元素指定一个「碰撞体积」，你可以把它理解成计算机可以理解的现实中的物品的形状。</p>

    <p>默认情况下系统的物理引擎会处理游戏中所有元素的移动等，但由于在之前的课上我们已经使用了自制的迷你物理引擎来处理重力、移动这些了，所以现在我们就只需要系统来帮我们进行碰撞检测就可以了，其他的功能可以关闭。</p>
  </li>
  <li>
    <p>我们自己来处理游戏元素的运动</p>
  </li>
</ol>

<ul>
  <li>关闭重力 <code class="highlighter-rouge">gravity = 0</code></li>
  <li>关闭碰撞处理 <code class="highlighter-rouge">collisonBitMask = 0</code></li>
  <li>打开碰撞检测</li>
</ul>

<p>关闭重力不用说了，碰撞处理是指系统会自动帮我们计算出碰撞后元素的位置速度等，我们不希望这样，所以要关闭。我们只要物体在接触，也就是碰撞的时候系统通知我们，让我们来处理就可以了。</p>

<p>那要实现这一点我们需要做的就是分别给我们的主角、障碍和地面指定他们的碰撞体积。</p>

<h3 id="section-2">物体的碰撞体积</h3>

<p>刚刚说了，为了实现我们的目标，我们首先要给每一个游戏元素设置一个碰撞体积，用来给系统的引擎检测碰撞。</p>

<p>当刚开始的时候，我们可能会想要使用一个矩形，因为很简单，看起来也差不多是吧。但是这样做不是很好，原因是我们这个图片中有透明的区域。</p>

<p>所以当我们的主角认为自己应该通过了一个障碍，但在游戏中却死掉了，原因是这些透明的区域碰到了障碍，那它会很生气，后果很严重！（差评、摔机……）</p>

<p>所以我们要想一个更好的办法，那就是我们自己用代码来绘制这个多边形区域。</p>

<p>当然，我们实际上并不会真的自己来写这些代码（自己写不仅容易出错，而且很麻烦），网上有现成的小工具来帮助我们来生成这些繁琐的代码。下面这个网址就是用来生成这个代码的，之后的 Demo 中我会教大家怎么使用这个工具。</p>

<p><a href="http://stackoverflow.com/questions/19040144/spritekits-skphysicsbody-with-polygon-helper-tool">SpriteKit 多边形代码生成工具</a></p>

<h2 id="demo-">Demo 时间</h2>

<p>图文TODO，请先参考视频内容。</p>

<p><a href="https://github.com/FangYiXiong/FlappyZoe/archive/part4-challenge-finished.zip">本节开始代码下载地址</a></p>

<p><a href="https://github.com/FangYiXiong/FlappyZoe/archive/part-5-finished.zip">本节完成后代码下载地址</a></p>

